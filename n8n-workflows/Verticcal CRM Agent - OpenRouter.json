{
  "name": "Verticcal CRM Agent - OpenRouter",
  "nodes": [
    {
      "parameters": {
        "options": {}
      },
      "id": "7c5b610a-e771-4f52-a411-fe729aaa1514",
      "name": "When chat message received",
      "type": "@n8n/n8n-nodes-langchain.chatTrigger",
      "typeVersion": 1.1,
      "position": [
        -480,
        560
      ],
      "webhookId": "64e0eb46-40d2-4cad-aca2-26c24b364a4c"
    },
    {
      "parameters": {},
      "id": "6acff405-1d5a-4f91-90f3-24a8c4e8d27c",
      "name": "Window Buffer Memory",
      "type": "@n8n/n8n-nodes-langchain.memoryBufferWindow",
      "typeVersion": 1.2,
      "position": [
        0,
        784
      ]
    },
    {
      "parameters": {
        "promptType": "define",
        "text": "=Eres un asistente de CRM inteligente especializado en gestión de contactos.\n\nTu trabajo es ayudar a los usuarios a:\n1. Crear contactos nuevos en el CRM\n2. Agregar notas a contactos existentes\n3. Actualizar información de contactos\n\nCuando el usuario te pida crear un contacto, usa la herramienta create_contact.\nCuando te pida agregar una nota, usa la herramienta add_note.\nCuando te pida actualizar un contacto, usa la herramienta update_contact.\n\nSiempre confirma las operaciones exitosas con mensajes claros que incluyan el ID del contacto.",
        "options": {}
      },
      "id": "942ae945-a31a-4a19-bd40-72ac1b3bc9ec",
      "name": "AI Agent",
      "type": "@n8n/n8n-nodes-langchain.agent",
      "typeVersion": 1.7,
      "position": [
        -144,
        560
      ]
    },
    {
      "parameters": {
        "model": "openai/gpt-4o",
        "options": {
          "maxTokens": 2000,
          "temperature": 0.7
        }
      },
      "id": "ef8c3d91-0a54-4781-9862-f8e3bc434ecf",
      "name": "OpenAI Model (via OpenRouter)",
      "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
      "typeVersion": 1,
      "position": [
        -144,
        768
      ],
      "credentials": {
        "openAiApi": {
          "id": "slLpmTkoppTi3fCz",
          "name": "OpenAi account"
        }
      }
    },
    {
      "parameters": {
        "method": "POST",
        "url": "http://localhost:8000/api/v1/contact",
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={{ JSON.stringify({ name: $fromAI('name', '', 'Nombre completo del contacto'), email: $fromAI('email', '', 'Email del contacto (opcional)'), phone: $fromAI('phone', '', 'Teléfono del contacto (opcional)') }) }}"
      },
      "id": "639a9193-0068-4664-9523-08d96ece469f",
      "name": "ToolCreateContact",
      "type": "@n8n/n8n-nodes-langchain.toolHttpRequest",
      "typeVersion": 1.1,
      "position": [
        416,
        592
      ]
    },
    {
      "parameters": {
        "method": "POST",
        "url": "http://localhost:8000/api/v1/contact/note",
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={{ JSON.stringify({ contact_id: parseInt($fromAI('contact_id', '', 'ID numérico del contacto')), content: $fromAI('content', '', 'Contenido de la nota') }) }}"
      },
      "id": "b14020cb-1e6d-4cd0-8055-413ed25d8d21",
      "name": "ToolAddNote",
      "type": "@n8n/n8n-nodes-langchain.toolHttpRequest",
      "typeVersion": 1.1,
      "position": [
        416,
        448
      ]
    },
    {
      "parameters": {
        "method": "PATCH",
        "url": "http://localhost:8000/api/v1/contact",
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={{ JSON.stringify({ contact_id: parseInt($fromAI('contact_id', '', 'ID del contacto a actualizar')), name: $fromAI('name', '', 'Nuevo nombre (opcional)'), email: $fromAI('email', '', 'Nuevo email (opcional)'), phone: $fromAI('phone', '', 'Nuevo teléfono (opcional)') }) }}"
      },
      "id": "852ad59b-6545-4c79-8fac-6b44d9382f56",
      "name": "ToolUpdateContact",
      "type": "@n8n/n8n-nodes-langchain.toolHttpRequest",
      "typeVersion": 1.1,
      "position": [
        400,
        304
      ]
    }
  ],
  "pinData": {},
  "connections": {
    "When chat message received": {
      "main": [
        [
          {
            "node": "AI Agent",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Window Buffer Memory": {
      "ai_memory": [
        [
          {
            "node": "AI Agent",
            "type": "ai_memory",
            "index": 0
          }
        ]
      ]
    },
    "OpenAI Model (via OpenRouter)": {
      "ai_languageModel": [
        [
          {
            "node": "AI Agent",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "ToolCreateContact": {
      "ai_tool": [
        [
          {
            "node": "AI Agent",
            "type": "ai_tool",
            "index": 0
          }
        ]
      ]
    },
    "ToolAddNote": {
      "ai_tool": [
        [
          {
            "node": "AI Agent",
            "type": "ai_tool",
            "index": 0
          }
        ]
      ]
    },
    "ToolUpdateContact": {
      "ai_tool": [
        [
          {
            "node": "AI Agent",
            "type": "ai_tool",
            "index": 0
          }
        ]
      ]
    }
  },
  "active": false,
  "settings": {
    "executionOrder": "v1"
  },
  "versionId": "2fd1cfb5-f088-4970-951b-4bf39fa8271a",
  "meta": {
    "templateCredsSetupCompleted": true,
    "instanceId": "185a760f73cd5fe16f9ecd978f0492b3ef5be27956aa2181147f8ba6615bf8ef"
  },
  "id": "vGqTDkMz1sxKYmUu",
  "tags": []
}